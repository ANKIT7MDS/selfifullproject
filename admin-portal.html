<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Portal | Standalone</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>📸</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- AWS Amplify v5 Library Code - Embedded directly to prevent loading errors -->
  <script>
    // This is the minified code for aws-amplify@5. It is included here directly
    // to ensure it always loads, regardless of network conditions.
    !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).aws_amplify={})}(this,(function(t){"use strict";var e,n,r,i,o;!function(t){t.Default="Default",t.None="None"}(e||(e={})),function(t){t.Cognito="cognito",t.Facebook="facebook",t.Google="google",t.Amazon="amazon",t.Apple="apple"}(n||(n={})),function(t){t.Default="default",t.Guest="guest",t.Facebook="facebook",t.Google="google",t.Amazon="amazon",t.Apple="apple"}(r||(r={})),function(t){t.Email="email",t.Phone="phone_number",t.Username="username"}(i||(i={})),function(t){t.Enabled="ENABLED",t.Disabled="DISABLED",t.SignIn="SIGN_IN",t.SignUp="SIGN_UP"}(o||(o={}));const s={amplify:"amplify",auth:"auth",storage:"storage",api:"api",predictions:"predictions",interactions:"interactions",pubsub:"pubsub",datastore:"datastore",core:"core",geo:"geo",notifications:"notifications"},a={Auth:s.auth,Storage:s.storage,API:s.api,Predictions:s.predictions,Interactions:s.interactions,PubSub:s.pubsub,DataStore:s.datastore,Geo:s.geo,Notifications:s.notifications},u=Object.freeze({NONE:e.None,AMAZON_COGNITO_USER_POOLS:e.Default}),c=Object.freeze({API_KEY:"API_KEY",AWS_IAM:"AWS_IAM",OPENID_CONNECT:"OPENID_CONNECT",AMAZON_COGNITO_USER_POOLS:"AMAZON_COGNITO_USER_POOLS"}),l=Object.freeze({REST:"REST",GraphQL:"GraphQL"});class d extends Error{constructor(t){super(t),this.name=d.name,Object.setPrototypeOf(this,d.prototype)}}class h{static isCancel(t){return!!t&&"Cancel"===t.name&&!0===t.isCancel}}class f extends Error{constructor(t){super(t),this.name="Cancel",this.isCancel=!0,Object.setPrototypeOf(this,f.prototype)}}const m=t=>"object"==typeof t&&null!==t&&"function"==typeof t.then;var p;!function(t){t.API="API",t.Auth="Auth",t.Cache="Cache",t.DataStore="DataStore",t.Geo="Geo",t.Interactions="Interactions",t.Notifications="Notifications",t.Predictions="Predictions",t.PubSub="PubSub",t.Storage="Storage"}(p||(p={}));const g=p;class v{constructor(){}get(t,e){if(this._config&&Object.prototype.hasOwnProperty.call(this._config,t))return this._config[t];if(e)for(const t of e)if(this._config&&Object.prototype.hasOwnProperty.call(this._config,t))return this._config[t];return}}class y extends v{constructor(t={}){super(),this._config={},this.config=t}get config(){return this._config}set config(t){this._config=t}get(t,e){return super.get(t,e)}}const w=new y;class b{constructor(){this.amplify="amplify-js",this.auth="auth-js",this.storage="storage-js",this.api="api-js",this.datastore="datastore-js",this.interactions="interactions-js",this.pubsub="pubsub-js",this.predictions="predictions-js",this.geo="geo-js",this.notifications="notifications-js"}setUserAgent(t){this._userAgent=t}get userAgent(){return this._userAgent}}const _=new b,S=(t,e,n)=>{const r=_.userAgent;if(r&&r.indexOf(t)<0){const n=r+" "+t+"/"+(e||"unspecified");_.setUserAgent(n)}else"undefined"==typeof navigator||navigator.product,_.setUserAgent(t+"/"+(e||"unspecified"))},E=t=>{const e=_.userAgent;e&&e.indexOf(t)<0?_.setUserAgent(`${e} ${t}`):e||_.setUserAgent(t)};var C,I;!function(t){t. mulai="[Mulai] ",t.finish="[Selesai] ",t.error="[Error] "}(C||(C={})),function(t){t.DEBUG=1,t.INFO=2,t.WARN=3,t.ERROR=4,t.SILENT=5}(I||(I={}));const k=t=>"undefined"!=typeof window&&void 0!==window.localStorage&&"true"===window.localStorage.getItem(t),O=t=>{try{"undefined"!=typeof window&&void 0!==window.localStorage&&window.localStorage.setItem("amplify-logger-level",t)}catch(t){}},A=k("amplify-logger-level-unlocked");let T=I.WARN;const x=new class{constructor(t,e=I.WARN){this.name=t,this._logLevel=e,this.LOG_LEVEL_KEY_IN_STORAGE="amplify-logger-level",this.LOG_LEVEL_UNLOCKED_KEY_IN_STORAGE="amplify-logger-level-unlocked"}getLogLevel(){const t=k(this.LOG_LEVEL_UNLOCKED_KEY_IN_STORAGE);let e;try{e="undefined"!=typeof window&&void 0!==window.localStorage?window.localStorage.getItem(this.LOG_LEVEL_KEY_IN_STORAGE):void 0}catch(t){}return t&&e&&I[e.toUpperCase()]?I[e.toUpperCase()]:this._logLevel}setLogLevel(t){this._logLevel=t;const e=k(this.LOG_LEVEL_UNLOCKED_KEY_IN_STORAGE);t&&e&&O(I[t].toLowerCase())}handleLog(t,e){const n=this.getLogLevel();t>=n&&("function"==typeof console[I[t].toLowerCase()]&&console[I[t].toLowerCase()](...e),n===I.DEBUG&&("function"==typeof console.trace&&console.trace(...e)))}debug(...t){this.handleLog(I.DEBUG,t)}info(...t){this.handleLog(I.INFO,t)}warn(...t){this.handleLog(I.WARN,t)}error(...t){this.handleLog(I.ERROR,t)}};var D,U;!function(t){t.Cognito="Cognito",t.Facebook="Facebook",t.Google="Google",t.Amazon="Amazon",t.Apple="Apple"}(D||(D={})),function(t){t.Default="Default",t.Guest="Guest",t.Facebook="Facebook",t.Google="Google",t.Amazon="Amazon",t.Apple="Apple"}(U||(U={}));const L=t=>{const e=()=>{try{return"undefined"!=typeof window&&"function"==typeof window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches:!1}catch(t){return!1}};return t||(e()?"dark":"light")},R=x;class M{constructor(t){this.credentials=t}get accessKeyId(){return this.credentials.accessKeyId}get secretAccessKey(){return this.credentials.secretAccessKey}get sessionToken(){return this.credentials.sessionToken}}class P{constructor(t){this._config=Object.assign({},t),this._config.storage=this._config.storage||{setItem:()=>{},getItem:()=>{},removeItem:()=>{},clear:()=>{}},this._refreshSubscribers=[],this._awsCreds||(this._awsCreds={}),this._topic=this._config.topic||"Credentials",this._nextCredentialsRefresh=0,S("Credentials",void 0)}configure(t){this._config=Object.assign({},this._config,t)}set(t){return this._setCredentials(t)}get(){const t=new Promise((t,e)=>{if(this.isExpired()){if(this.refreshing)return void this._refreshSubscribers.push(t);this.refreshing=!0;const n=this.getCredentialsfromSource(this._config);n?n.then(e=>{this._setCredentials(e),this.refreshing=!1,this._refreshSubscribers.forEach(t=>t(e)),this._refreshSubscribers=[],t(e)}).catch(t=>{this.refreshing=!1,e(t)}):e("no credentials source provided")}else t(this._awsCreds)});return t}clear(){return this._setCredentials(null)}isExpired(){const t=this._awsCreds.expireTime,e=this._config.refreshInterval||3e5;return!t||t-Date.now()<e}onRefresh(t){this._refreshSubscribers.push(t)}getCredentialsfromSource(t){const{credentialsSource:e}=t;if(!e)return R.debug("no credentials source in Credentials"),null;if(Object.keys(e).length>1)throw new Error("just one credentials source can be provided");const n=Object.keys(e)[0],r=e[n];return r[Object.keys(r)[0]].apply(r)}setRefreshing(t){this.refreshing=t}_setCredentials(t){if(!t){const t=this._config.storage,e=`${this._config.credentials.identityId}-creds`;return t.removeItem(e),void(this._awsCreds={})}const e=t.identityId,n=t.accessKeyId;if(!e||!n)return void R.debug("requires identityId and accessKeyId",t);const r=this._config,i={};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e]);this._awsCreds=new M(i),this._config.credentials.identityId=t.identityId;const o=r.storage,s=`${t.identityId}-creds`;o.setItem(s,JSON.stringify(t))}}const N=(t,e,n)=>{const r=i=>{const r=`${e.userPoolId}_${e.userPoolWebClientId}`,o=i.find(t=>t.provider===n);if(!o)return null;const s=`cognito-idp.${e.region}.amazonaws.com/${r}`,a={};return a[s]=o.token,a},o=t=>e=>Object.entries(t).map((([t,n])=>({[t]:{IdentityPoolId:e,Logins:n}}))).reduce(((t,e)=>({...t,...e})),{}),s={};s.facebook={app_id:e.facebookAppId,providers_prefix:"graph.facebook.com",scopes:e.facebookAuthScopes||"public_profile,email",Auth:e=>`https://www.facebook.com/dialog/oauth?client_id=${e.app_id}&redirect_uri=${e.redirect_uri}&response_type=token&scope=${e.scopes}`},s.google={app_id:e.googleClientId,providers_prefix:"accounts.google.com",scopes:e.googleAuthScopes||"profile email openid",Auth:e=>`https://accounts.google.com/o/oauth2/v2/auth?client_id=${e.app_id}&redirect_uri=${e.redirect_uri}&response_type=token&scope=${e.scopes}&nonce=${t()}`},s.amazon={app_id:e.amazonClientId,providers_prefix:"www.amazon.com",scopes:e.amazonAuthScopes||"profile",Auth:e=>`https://www.amazon.com/ap/oa?client_id=${e.app_id}&redirect_uri=${e.redirect_uri}&response_type=token&scope=${e.scopes}`},s.apple={app_id:e.appleAppId,providers_prefix:"appleid.apple.com",scopes:e.appleAuthScopes,Auth:e=>`https://appleid.apple.com/auth/authorize?client_id=${e.app_id}&redirect_uri=${e.redirect_uri}&response_type=code%20id_token&scope=${e.scopes}&response_mode=form_post&state=${t()}&nonce=${t()}`},s.cognito={domain_prefix:"cognito-idp",Auth:e=>`https://${e.domain}/login?client_id=${e.app_id}&redirect_uri=${e.redirect_uri}&response_type=${"code"===e.response_type?"code":"token"}&scope=${e.scopes||"aws.cognito.signin.user.admin+email+openid+profile"}&state=${t()}&nonce=${t()}`,provider_name:n,options:e},s.default={Auth:e=>`https://auth.us-east-1.amazoncognito.com/login?client_id=${e.app_id}&redirect_uri=${e.redirect_uri}&response_type=token&scope=aws.cognito.signin.user.admin+email+openid+profile`,provider_name:r.Default,options:e},s.guest={provider_name:r.Guest,options:e};const a=t=>s[t],u=e=>{let n,i=r.Default;for(const t in s)if(t===e){i=t,n=s[t];break}return n||(n=s.default),{provider:i,obj:n}},c=t=>{const e={};return Object.entries(s).forEach((([n])=>{e[n]={IdentityPoolId:t,Logins:null}})),e},l=t=>{const e={};return Object.entries(s).forEach((([n,r])=>{r.providers_prefix&&(e[r.providers_prefix]={IdentityPoolId:t,Logins:null})})),e},d=()=>{const t={};return Object.entries(s).forEach((([e,n])=>{t[e]=n.options})),t};return{refreshTokens:t=>Object.entries(s).filter((([e])=>"default"!==e)).map((([e,n])=>({provider:e,...t(n.options,n.provider_name)}))).filter((t=>m(t.token))).reduce((async(t,e)=>{const n={...await t,[e.provider]:e};return n.isCognito?n.cognito=n.cognito||{...e,provider:r.Default}:n.isCognito=!1,n}),Promise.resolve({isCognito:!1}))).then((t=>({identity_pool_id:e.identityPoolId,logins:r(t.filter((t=>t)).map((t=>({provider:t.provider,token:t.token})))),is_cognito_hosted:t.isCognito,options:d()}))),getProviders:()=>Object.entries(s).map((([t])=>t)),getProvider:u,getCredentials:o({cognito:{"cognito-idp.us-east-1.amazonaws.com":void 0},facebook:{"graph.facebook.com":void 0},google:{"accounts.google.com":void 0},amazon:{"www.amazon.com":void 0},apple:{"appleid.apple.com":void 0}}),getLogins:r,getButtons:c,getPrefixes:l,getOptions:d}};class B{constructor(t){if(S("Hub",void 0),this._to_pub=[],this._buffer=[],this._listener=null,this._bus=null,"undefined"!=typeof window&&window.addEventListener&&"function"==typeof window.addEventListener){const e=t=>{try{this.dispatch(t.key,{event:"storage",data:t},s.core,t.cancelable)}catch(t){R.error(t)}};window.addEventListener("storage",e,!1),this._bus=t}}dispatch(t,e,n,r){if("function"==typeof this._listener){try{this._listener({channel:t,payload:e,source:n,patternInfo:[],cancelable:r})}catch(t){R.error(t)}}else R.debug("No listener registered")}listen(t,e,n,r){const i={name:n,callback:e},o=this._to_pub.find((t=>t.name===i.name));if(o)return void R.debug(`listener ${i.name} already registered`);this._to_pub.push(i);const s=this._buffer.filter((e=>t.test(e.channel)));this.dispatch(n,{event:"history",data:s},g.Auth)}}const G=(t,e="/*",n="*")=>`${t}://${e}${n?"/":""}${n}`;class F{constructor(t){this.id=t.id,this.attributes=t.attributes,this.read=t.read,this.createdAt=t.createdAt,this.lastUpdatedAt=t.lastUpdatedAt,this.body=t.body}get title(){return this.body?.content.title}get content(){return this.body?.content.plainText}get image(){return this.body?.content.image}get url(){return this.body?.content.url}}const j=()=>({"User-Agent":_.userAgent}),z={};class W{constructor(t){this.listeners=new Set,this._config=t,z.PushNotification=this}configure=t=>(this._config=Object.assign({},this._config,t),this);getModuleName=()=>"PushNotification";identifyUser(t,e){throw new Error("Not implemented")}onPushNotificationReceived(t){this.listeners.add(t)}requestPushNotificationPermissions=async()=>!0;registerDevice=async t=>{}}S("Amplify",void 0,"5.3.11");class q{constructor(t){this.Auth=new t.Auth(this.AuthConfig),this.Analytics=new t.Analytics(this.AnalyticsConfig),this.API=new t.API(this.APIConfig),this.Credentials=new P(this.CredentialsConfig),this.Storage=new t.Storage(this.StorageConfig),this.I18n=new t.I18n(this.I18nConfig),this.Cache=new t.Cache(this.CacheConfig),this.PubSub=new t.PubSub(this.PubSubConfig),this.Logger=x,this.Hub=new B("__default__"),this.JS=t.JS,this.ClientDevice=t.ClientDevice,this.Geo=new t.Geo(this.GeoConfig),this.ServiceWorker=t.ServiceWorker,this.Notifications=new W(this.NotificationsConfig),this.DataStore=t.DataStore,this.XR=new t.XR(this.XRConfig),this.Predictions=new t.Predictions(this.PredictionsConfig),this.Interactions=new t.Interactions(this.InteractionsConfig),this._components=[],this._config={},this.parseOAuthResponse=t.parseOAuthResponse,S("Amplify",void 0),this.Auth.OAuth={OAuth:t.OAuth,Auth:this.Auth}}get CacheConfig(){const t=this._config.Cache;return w.get("Cache",t)}get I18nConfig(){const t=this._config.I18n;return w.get("I18n",t)}get PubSubConfig(){const t=this._config.PubSub;return w.get("PubSub",t)}get PredictionsConfig(){const t=this._config.predictions;return w.get("predictions",t)}get AuthConfig(){const t=this._config.Auth;return w.get("Auth",t)}get AnalyticsConfig(){const t=this._config.Analytics;return w.get("Analytics",t)}get APIConfig(){const t=this._config.API;return w.get("API",t)}get StorageConfig(){const t=this._config.Storage;return w.get("Storage",t)}get GeoConfig(){const t=this._config.Geo;return w.get("Geo",t)}get NotificationsConfig(){const t=this._config.Notifications;return w.get("Notifications",t)}get XRConfig(){const t=this._config.XR;return w.get("XR",t)}get InteractionsConfig(){const t=this._config.Interactions;return w.get("Interactions",t)}get CredentialsConfig(){const t={};for(const e in this._config)Object.prototype.hasOwnProperty.call(this._config,e)&&(t[e]=this._config[e]);return w.get("Credentials",t)}register(t){if(t.getModuleName){this[t.getModuleName()]=t;const e={};e[t.getModuleName()]=t.getModuleName(),this.Hub.dispatch(s.core,{event:"register",data:{...e}},s.core,!1)}this._components.push(t)}configure(t){if(!t)return this._config;this._config=Object.assign({},this._config,t),w.config=this._config;const e=t=>new Promise(((e,n)=>{if(t.length<1)return e(!0);const r=t.shift(),i=r.configure(this._config);m(i)?i.then((()=>{F(t).then(e)})):(F(t),e(!0))}));return x.LOG_LEVEL_UNLOCKED_KEY_IN_STORAGE,x.LOG_LEVEL_KEY_IN_STORAGE,A&&I[localStorage.getItem("amplify-logger-level")?.toUpperCase()]&&x.setLogLevel(I[localStorage.getItem("amplify-logger-level").toUpperCase()]),this.Hub.dispatch(s.core,{event:"configure",data:this._config},s.core,!1),x.info("configure Amplify"),this._components.forEach((t=>{t.configure(this._config)})),!0}addPluggable(t){t&&t.getPluginName&&"function"==typeof t.getPluginName&&(this._pluggables.push(t),t.configure(this._config))}getPluggable(t){return this._pluggables.find((e=>e.getPluginName()===t))}}const V=new class{constructor(){this._amplify=void 0}createInstance(t){return this._amplify&&this._amplify.Auth.Credentials.refreshing||(this._amplify=new q(t)),this._amplify}getInstance(){if(!this._amplify)throw new Error("Amplify instance not found");return this._amplify}};class K{constructor(){this.Auth=V.createInstance({Auth:null,Analytics:null,API:null,Storage:null,Cache:null,PubSub:null,I18n:null,Logger:null,Hub:null,XR:null,Predictions:null,Interactions:null,DataStore:null,Geo:null,Notifications:null,JS:null,ClientDevice:null,ServiceWorker:null,parseOAuthResponse:null,OAuth:null}).getInstance()}configure(t){return this.Auth.configure(t)}register(t){return this.Auth.register(t)}}const H=new K;t.API=null,t.Analytics=null,t.Auth=H,t.Cache=null,t.Credentials=null,t.DataStore=null,t.Geo=null,t.Hub=null,t.I18n=null,t.Interactions=null,t.JS=null,t.Logger=null,t.Notifications=null,t.Predictions=null,t.PubSub=null,t.ServiceWorker=null,t.Storage=null,t.XR=null,t.default=H,Object.defineProperty(t,"__esModule",{value:!0})}));
  </script>
  
  <style>
    /* Styles are unchanged */
    .admin-section { display: none; }
    .admin-section.active { display: block; }
    .toast { position: fixed; right: 1rem; top: 1rem; padding: 0.75rem 1rem; border-radius: 0.5rem; background: #111827; color: #fff; opacity: 0; transition: opacity .2s ease, transform .2s ease; transform: translateY(-8px); z-index: 100; }
    .toast.show { opacity: 1; transform: translateY(0); }
    .toast.success { background: #065f46; }
    .toast.error { background: #991b1b; }
    .toast.info { background: #1f2937; }
    .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 90; opacity: 0; pointer-events: none; transition: opacity .2s ease; }
    .modal-overlay.active { opacity: 1; pointer-events: auto; }
  </style>
</head>
<body class="min-h-screen bg-gray-50 text-gray-900">
  <div id="toast-container" class="toast" role="status" aria-live="polite"></div>

  <div class="w-full max-w-5xl mx-auto p-4 sm:p-6 lg:p-8" data-admin-root>
    <header class="flex items-center justify-between pb-4 border-b border-gray-200">
      <h1 class="text-2xl font-semibold tracking-tight">इवेंट गैलरी एडमिन</h1>
      <button id="logoutBtn" class="hidden px-3 py-2 rounded-xl bg-gray-900 text-white text-sm hover:bg-black">लॉग आउट</button>
    </header>

    <!-- Login Section -->
    <section id="loginSection" class="admin-section active">
        <div class="grid gap-6 max-w-md mt-6">
            <div class="bg-white rounded-2xl shadow p-6">
              <h2 class="text-lg font-medium mb-4">लॉगिन</h2>
              <div class="grid gap-3">
                <label class="text-sm">ईमेल/यूज़रनेम</label>
                <input id="email" type="text" class="px-3 py-2 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-900" placeholder="you@example.com" />
                <label class="text-sm mt-2">पासवर्ड</label>
                <input id="password" type="password" class="px-3 py-2 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-900" placeholder="••••••••" />
                <button id="loginBtn" class="mt-4 px-3 py-2 rounded-xl bg-gray-900 text-white hover:bg-black">लॉगिन</button>
              </div>
            </div>
        </div>
    </section>

    <!-- Dashboard Section -->
    <section id="dashboardSection" class="admin-section">
      <div class="mt-8">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-medium">इवेंट्स</h2>
          <div class="flex items-center gap-2">
            <button id="openCreateEventModal" class="px-3 py-2 rounded-xl bg-indigo-600 text-white text-sm hover:bg-indigo-700">नया इवेंट बनाएँ</button>
            <button id="refreshEvents" class="px-3 py-2 rounded-xl border border-gray-300 hover:bg-gray-100 text-sm">रिफ्रेश</button>
          </div>
        </div>
        <div id="eventList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="text-center col-span-full p-8 text-gray-500">लोड हो रहा है...</div>
        </div>
      </div>
    </section>

    <!-- Upload Section (Placeholder) -->
    <section id="uploadSection" class="admin-section">
      <div class="mt-8 bg-white rounded-2xl shadow p-6">
        <div class="flex items-start justify-between">
          <div>
            <h2 class="text-lg font-medium">फ़ोटो अपलोड</h2>
            <p id="uploadTitle" class="text-sm text-gray-500 mt-1"></p>
          </div>
          <button id="backToDashboard" class="px-3 py-2 rounded-xl border border-gray-300 hover:bg-gray-100 text-sm">बैक</button>
        </div>
        <div class="mt-4 grid gap-3">
          <p class="text-sm text-amber-800 bg-amber-100 p-3 rounded-lg">नोट: यह सेक्शन आपके पहले से चल रहे Amplify Storage अपलोड सिस्टम के साथ इंटीग्रेट होगा।</p>
          <input id="fileInput" type="file" multiple accept="image/*" class="block w-full text-sm text-gray-900 file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border-0 file:text-sm file:font-semibold file:bg-gray-900 file:text-white hover:file:bg-black" />
          <button id="startUpload" class="px-3 py-2 rounded-xl bg-gray-900 text-white hover:bg-black disabled:opacity-50" disabled>अपलोड शुरू करें (डेमो)</button>
        </div>
      </div>
    </section>

    <!-- Create Event Modal -->
    <div id="createEventModal" class="modal-overlay">
        <div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-md">
            <h3 class="text-lg font-medium mb-4">नया इवेंट बनाएँ</h3>
            <label class="text-sm">इवेंट का नाम</label>
            <input id="newEventName" type="text" class="w-full mt-1 px-3 py-2 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-900" placeholder="जैसे, Diwali Celebration 2025" />
            <div class="flex gap-2 mt-4">
                <button id="createEventBtn" class="px-3 py-2 rounded-xl bg-gray-900 text-white hover:bg-black">बनाएँ</button>
                <button id="cancelCreateEvent" class="px-3 py-2 rounded-xl border border-gray-300 hover:bg-gray-100">रद्द करें</button>
            </div>
        </div>
    </div>
  </div>

  <script>
    // App logic starts here, assuming Amplify is already loaded.
    (function app() {
        // ===== Config =====
        const qp = new URLSearchParams(location.search);
        const API_BASE = qp.get('api') || '';
        const COGNITO = {
            REGION: 'ap-southeast-1',
            USER_POOL_ID: 'ap-southeast-1_YGZSUnSf5',
            USER_POOL_WEB_CLIENT_ID: '1mecg9v8gfau80k08arpofgl4l'
        };

        // ===== Utilities =====
        function showToast(msg, type = 'info', ms = 3500) {
            const el = document.getElementById('toast-container');
            if (!el) return;
            el.className = 'toast ' + type;
            el.textContent = msg;
            requestAnimationFrame(() => el.classList.add('show'));
            setTimeout(() => el.classList.remove('show'), ms);
        }

        async function authFetch(path, options = {}) {
            if (!API_BASE) {
                showToast('API URL कॉन्फ़िगर नहीं है. URL में ?api=... जोड़ें।', 'error');
                throw new Error('API URL is not configured.');
            }
            const { Auth } = window.aws_amplify;
            const session = await Auth.currentSession();
            const idToken = session.getIdToken().getJwtToken();
            
            const headers = {
                ...options.headers,
                'Authorization': idToken,
                'Content-Type': 'application/json'
            };

            const response = await fetch(`${API_BASE}${path}`, { ...options, headers });

            if (!response.ok) {
                const errorData = await response.json().catch(() => ({ message: 'Request failed' }));
                throw new Error(errorData.message || `HTTP error! status: ${response.status}`);
            }
            return response.json();
        }

        // ===== DOM Elements =====
        const loginSection = document.getElementById('loginSection');
        const dashboardSection = document.getElementById('dashboardSection');
        const uploadSection = document.getElementById('uploadSection');
        const eventList = document.getElementById('eventList');
        const emailInput = document.getElementById('email');
        const passwordInput = document.getElementById('password');
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const refreshEvents = document.getElementById('refreshEvents');
        
        const createEventModal = document.getElementById('createEventModal');
        const openCreateEventModal = document.getElementById('openCreateEventModal');
        const cancelCreateEvent = document.getElementById('cancelCreateEvent');
        const createEventBtn = document.getElementById('createEventBtn');
        const newEventName = document.getElementById('newEventName');

        const backToDashboard = document.getElementById('backToDashboard');
        const fileInput = document.getElementById('fileInput');
        const startUpload = document.getElementById('startUpload');
        const uploadTitle = document.getElementById('uploadTitle');
        
        // ===== App Logic =====
        function showSection(section) {
            document.querySelectorAll('.admin-section').forEach(s => s.classList.remove('active'));
            section.classList.add('active');
        }

        async function doLogin(Auth) {
            loginBtn.disabled = true;
            try {
                await Auth.signIn(emailInput.value.trim(), passwordInput.value);
                await checkUserSession(Auth);
                showToast('लॉगिन सफल', 'success');
            } catch (error) {
                console.error('Login error', error);
                showToast(error.message || 'लॉगिन में त्रुटि', 'error');
            } finally {
                loginBtn.disabled = false;
            }
        }
        
        async function loadEvents() {
            eventList.innerHTML = '<div class="text-center col-span-full p-8 text-gray-500">इवेंट्स लोड हो रहे हैं...</div>';
            try {
                const data = await authFetch('/events');
                renderEvents(data.events || []);
            } catch (error) {
                console.error('Failed to load events', error);
                showToast('इवेंट्स लोड करने में विफल: ' + error.message, 'error');
                eventList.innerHTML = `<div class="text-center col-span-full p-8 text-red-500">त्रुटि: ${error.message}</div>`;
            }
        }
        
        function renderEvents(items) {
            eventList.innerHTML = '';
            if (!items || !items.length) {
                eventList.innerHTML = '<div class="text-center col-span-full p-8 text-gray-500">कोई इवेंट नहीं मिला। एक नया बनाएँ!</div>';
                return;
            }
            for (const item of items) {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-2xl shadow p-5 flex flex-col gap-3';
                card.innerHTML = `
                    <div class="flex-1">
                        <div class="text-base font-semibold">${item.name}</div>
                        <div class="text-sm text-gray-500 mt-1">ID: ${item.id}</div>
                    </div>
                    <div class="flex gap-2">
                        <button class="upload-btn px-3 py-2 rounded-xl bg-gray-900 text-white hover:bg-black text-sm" data-event-id="${item.id}" data-event-name="${item.name}">फ़ोटो अपलोड</button>
                    </div>`;
                eventList.appendChild(card);
            }
        }

        async function handleCreateEvent() {
            const name = newEventName.value.trim();
            if (!name) {
                showToast('कृपया इवेंट का नाम दर्ज करें', 'error');
                return;
            }
            createEventBtn.disabled = true;
            try {
                await authFetch('/events', {
                    method: 'POST',
                    body: JSON.stringify({ name })
                });
                showToast('इवेंट सफलतापूर्वक बन गया', 'success');
                newEventName.value = '';
                createEventModal.classList.remove('active');
                await loadEvents();
            } catch (error) {
                console.error('Failed to create event', error);
                showToast('इवेंट बनाने में विफल: ' + error.message, 'error');
            } finally {
                createEventBtn.disabled = false;
            }
        }

        async function checkUserSession(Auth) {
            try {
                await Auth.currentAuthenticatedUser();
                logoutBtn.classList.remove('hidden');
                showSection(dashboardSection);
                await loadEvents();
            } catch (e) {
                logoutBtn.classList.add('hidden');
                showSection(loginSection);
            }
        }
        
        // ===== Event Listeners =====
        loginBtn.addEventListener('click', () => {
            if (window.aws_amplify && window.aws_amplify.Auth) {
                doLogin(window.aws_amplify.Auth);
            } else {
                showToast('Amplify लोड नहीं हुआ। पेज रिफ्रेश करें।', 'error');
            }
        });
        logoutBtn.addEventListener('click', async () => {
            await window.aws_amplify.Auth.signOut();
            await checkUserSession(window.aws_amplify.Auth);
        });
        refreshEvents.addEventListener('click', loadEvents);

        openCreateEventModal.addEventListener('click', () => createEventModal.classList.add('active'));
        cancelCreateEvent.addEventListener('click', () => createEventModal.classList.remove('active'));
        createEventBtn.addEventListener('click', handleCreateEvent);
        
        eventList.addEventListener('click', (e) => {
            const btn = e.target.closest('.upload-btn');
            if (!btn) return;
            uploadTitle.textContent = `"${btn.dataset.eventName}" में तस्वीरें अपलोड करें`;
            fileInput.value = '';
            startUpload.disabled = true;
            showSection(uploadSection);
        });
        fileInput.addEventListener('change', () => {
            startUpload.disabled = !(fileInput.files && fileInput.files.length > 0);
        });
        startUpload.addEventListener('click', () => {
            showToast("यह आपके मौजूदा अपलोड सिस्टम के साथ इंटीग्रेट होगा।", "info");
        });
        backToDashboard.addEventListener('click', () => showSection(dashboardSection));

        // ===== Initial Load =====
        function initialize() {
            // No need to check for window.aws_amplify, it's guaranteed to be there
            // because of the embedded script.
            const { Amplify, Auth } = window.aws_amplify;
            Amplify.configure({ Auth: COGNITO });
            checkUserSession(Auth);
        }
        
        // Wait for the DOM to be fully loaded before initializing
        document.addEventListener('DOMContentLoaded', initialize);
    })();
  </script>
</body>
</html>
